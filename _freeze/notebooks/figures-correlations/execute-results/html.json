{
  "hash": "f04572e96a6fc66973b2618d89918f9d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Code for Figures 3-4 based on Pearson's correlations\"\nauthor: \"Eduard Klapwijk\"\n---\n\nLoad libraries to produce figures:\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\n# load libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(patchwork)\n# load devtools library and load neuro-up package from github repo\nlibrary(devtools)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: usethis\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\ninstall_github(\"eduardklap/neuroUp\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSkipping install of 'neuroUp' from a github remote, the SHA1 (e2603d42) has not changed since last install.\n  Use `force = TRUE` to force installation\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(neuroUp)\n```\n:::\n\n\nSet seed and create Figure 3a for the Feedback task DLPFC ROI:\n\n::: {#cell-fig-3a .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3a\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# calculate difference mfg_learning vs. mfg_application\ndata_feedback <- feedback\ndata_feedback$dif <- data_feedback$mfg_learning - data_feedback$mfg_application\n\n# Estimate correlations\nfeedback_fig <- estim_corr(data = data_feedback,\n                           vars_of_interest = c(\"dif\", \"age\"),\n                           sample_size = 20:271, \n                           k = 1000, \n                           name = \"A. Feedback DLPFC corr. with age\")\n# plot figure 3a\nfeedback_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-3a-1.png){#fig-3a width=672}\n:::\n:::\n\n\nPlot Figure 4a for the Feedback task DLPFC ROI:\n\n::: {#cell-fig-4a .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-4a\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 4a\nfeedback_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-4a-1.png){#fig-4a width=672}\n:::\n:::\n\n\nSet seed and create Figure 3b for the Gambling task NAcc ROI:\n\n::: {#cell-fig-3b .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3b\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# Estimate correlations\ngambling_fig <- estim_corr(data = gambling, \n                           vars_of_interest = c(\"lnacc_self_winvsloss\", \n                                                \"age\"), \n                           sample_size = 20:221, \n                           k = 1000, \n                           name = \"B. Gambling NAcc corr. with age\")\n\n# plot figure 3b\ngambling_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-3b-1.png){#fig-3b width=672}\n:::\n:::\n\n\nPlot Figure 4b for the Gambling task NAcc ROI:\n\n::: {#cell-fig-4b .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-4b\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 4b\ngambling_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-4b-1.png){#fig-4b width=672}\n:::\n:::\n\n\nSet seed and create Figure 3c for the Self-evaluations task mPFC ROI:\n\n::: {#cell-fig-3c .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3c\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# calculate difference mpfc_self - mpfc_control\ndata_self <- self_eval\ndata_self$dif <- data_self$mpfc_self - data_self$mpfc_control\n\n# Estimate correlations\nselfeval_fig <- estim_corr(data = data_self,\n                           vars_of_interest = c(\"dif\",\n                                                \"age\"),\n                           sample_size = 20:149, \n                           k = 1000, \n                           name = \"C. Self-evaluations mPFC corr. with age\")\n\n# plot figure 3c\nselfeval_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-3c-1.png){#fig-3c width=672}\n:::\n:::\n\n\nPlot Figure 4c for the Self-evaluations task mPFC ROI:\n\n::: {#cell-fig-4c .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-4c\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 4c\nselfeval_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-4c-1.png){#fig-4c width=672}\n:::\n:::\n\n\nSet seed and create Figure 3D for the Gaining for self task NAcc ROI:\n\n::: {#cell-fig-3d .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3d\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# calculate difference nacc_selfgain vs. nacc_bothnogain\ndata_vicar <- vicar_char\ndata_vicar$dif <- data_vicar$nacc_selfgain - data_vicar$nacc_bothnogain\n\n# Estimate correlations\nvicar_char_fig <- estim_corr(data = data_vicar, \n                             vars_of_interest = c(\"dif\", \n                                                  \"age\"),\n                             sample_size = 20:156, \n                             k = 1000, \n                             name = \"D. Gaining self NAcc corr. with age\")\n\n# plot figure 3d\nvicar_char_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-3d-1.png){#fig-3d width=672}\n:::\n:::\n\n\nPlot Figure 4d for the Gaining for self task NAcc ROI:\n\n::: {#cell-fig-4d .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-4d\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 4d\nvicar_char_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-html/fig-4d-1.png){#fig-4d width=672}\n:::\n:::\n\n\nPlot Figure 3 (4 data sets combined):\n\n::: {#cell-fig-3 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n#| fig-height: 6\n#| fig-width: 10\n#| fig-cap: \"Estimates of Pearson’s correlation between age and the task effect for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset). For each sample size 10 randomly chosen HDCI’s out of the 1000 HDCI’s computed are displayed (in green, permutation numbers used are displayed to the right of each subfigure). The average estimate with credible interval summarizing the 1000 HDCI’s for each sample size are plotted in orange. DLPFC = dorsolateral prefrontal cortex; mPFC = medial prefrontal cortex; NAcc = nucleus accumbens. Age is modeled as linearly increasing or decreasing.\"\n# plot figure 3 using patchwork library\nfeedback_fig$fig_corr + gambling_fig$fig_corr + selfeval_fig$fig_corr + vicar_char_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![Estimates of Pearson’s correlation between age and the task effect for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset). For each sample size 10 randomly chosen HDCI’s out of the 1000 HDCI’s computed are displayed (in green, permutation numbers used are displayed to the right of each subfigure). The average estimate with credible interval summarizing the 1000 HDCI’s for each sample size are plotted in orange. DLPFC = dorsolateral prefrontal cortex; mPFC = medial prefrontal cortex; NAcc = nucleus accumbens. Age is modeled as linearly increasing or decreasing.](figures-correlations_files/figure-html/fig-3-1.png){#fig-3 width=960}\n:::\n:::\n\n\nPlot Figure 4 (4 data sets combined):\n\n::: {#cell-fig-4 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-4\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n#| fig-height: 6\n#| fig-width: 10\n#| fig-cap: \"For each task, for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset), the proportion of intervals not containing the value 0 is plotted in orange. Age is modeled as linearly increasing or decreasing.\"\n# plot figure 4 using patchwork library\nfeedback_fig$fig_corr_nozero + gambling_fig$fig_corr_nozero + selfeval_fig$fig_corr_nozero + vicar_char_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![For each task, for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset), the proportion of intervals not containing the value 0 is plotted in orange. Age is modeled as linearly increasing or decreasing.](figures-correlations_files/figure-html/fig-4-1.png){#fig-4 width=960}\n:::\n:::\n\n\nExtract numbers to produce table 3:\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: data-summary-corr\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# first extract tibble from results (select mean only)\nfeedback_sum <- as_tibble(feedback_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngambling_sum <- as_tibble(gambling_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\nselfeval_sum <- as_tibble(selfeval_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngaining_sum <- as_tibble(vicar_char_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\n```\n:::\n\n\nUse numbers to produce a table in text:\n\n| task             | brain region | n = 20                                                                                                                    | n = 2/5                                                                                                                                                | n = 3/5                                                                                                                                                | n = 4/5                                                                                                                                                | N = total                                                                                                                                              |\n|-----------|-----------|-----------|-----------|-----------|-----------|-----------|\n| Feedback         | DLPFC        | **0.38** (-0.06, 0.69) | **0.38** (0.16, 0.56), *n =* 70 | **0.37** (0.21, 0.52), *n =* 120 | **0.38** (0.24, 0.5), *n =* 170 | **0.38** (0.27, 0.47), *N* = 271 |\n| Gambling         | NAcc         | **-0.02** (-0.44, 0.4) | **-0.04** (-0.29, 0.21), *n =* 60 | **-0.04** (-0.23, 0.16), *n =* 100 | **-0.04** (-0.2, 0.13), *n =* 140 | **-0.04** (-0.17, 0.09), *N =* 221 |\n| Self-evaluations | mPFC         | **0.07** (-0.36, 0.48) | **0.06** (-0.23, 0.34), *n =* 46 | **0.06** (-0.17, 0.29), *n =* 72 | **0.06** (-0.14, 0.25), *n =* 98 | **0.06** (-0.1, 0.22), *N* = 149 |\n| Gaining self     | NAcc         | **-0.18** (-0.56, 0.26)    | **-0.17** (-0.44, 0.11), *n =* 47     | **-0.17** (-0.38, 0.06), *n =* 74     | **-0.17** (-0.35, 0.03), *n =* 101     | **-0.17** (-0.31, -0.01), *N* = 156      |\n",
    "supporting": [
      "figures-correlations_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}