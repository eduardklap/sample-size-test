{
  "hash": "8c8465170a7b324200efdfc338f2db24",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Code for Figures 3-4 based on Pearson's correlations\"\nauthor: \"Eduard Klapwijk\"\n---\n\n\nLoad libraries to produce figures:\n\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\n# load libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(patchwork)\n# load devtools library and load neuro-up package from github repo\nlibrary(devtools)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: usethis\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\ninstall_github(\"eduardklap/neuroUp\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nSkipping install of 'neuroUp' from a github remote, the SHA1 (e2603d42) has not changed since last install.\n  Use `force = TRUE` to force installation\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(neuroUp)\n```\n:::\n\n\nSet seed and create Figure 3a for the Feedback task DLPFC ROI:\n\n\n::: {#cell-fig-3a .cell}\n\n```{.r .cell-code}\n#| label: fig-3a\n# set seed\nset.seed(1234)\n\n# calculate difference mfg_learning vs. mfg_application\ndata_feedback <- feedback\ndata_feedback$dif <- data_feedback$mfg_learning - data_feedback$mfg_application\n\n# Estimate correlations\nfeedback_fig <- estim_corr(data = data_feedback,\n                           vars_of_interest = c(\"dif\", \"age\"),\n                           sample_size = 20:271, \n                           k = 10, \n                           name = \"Feedback DLPFC corr. with age\")\n# plot figure 3a\nfeedback_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-3a-1.png){#fig-3a}\n:::\n:::\n\n\nPlot Figure 4a for the Feedback task DLPFC ROI:\n\n\n::: {#cell-fig-4a .cell}\n\n```{.r .cell-code}\n#| label: fig-4a\n# plot figure 4b\nfeedback_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-4a-1.png){#fig-4a}\n:::\n:::\n\n\nSet seed and create Figure 3b for the Gambling task NAcc ROI:\n\n\n::: {#cell-fig-3b .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3b\n# set seed\nset.seed(1234)\n\n# Estimate correlations\ngambling_fig <- estim_corr(data = gambling, \n                           vars_of_interest = c(\"lnacc_self_winvsloss\", \n                                                \"age\"), \n                           sample_size = 20:221, \n                           k = 10, \n                           name = \"Gambling NAcc corr. with age\")\n\n# plot figure 3b\ngambling_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-3b-1.png){#fig-3b}\n:::\n:::\n\n\nPlot Figure 4b for the Gambling task NAcc ROI:\n\n\n::: {#cell-fig-4b .cell}\n\n```{.r .cell-code}\n#| label: fig-4b\n# plot figure 4b\ngambling_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-4b-1.png){#fig-4b}\n:::\n:::\n\n\nSet seed and create Figure 3c for the Self-evaluations task mPFC ROI:\n\n\n::: {#cell-fig-3c .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3c\n# set seed\nset.seed(1234)\n\n# calculate difference mpfc_self - mpfc_control\ndata_self <- self_eval\ndata_self$dif <- data_self$mpfc_self - data_self$mpfc_control\n\n# Estimate correlations\nselfeval_fig <- estim_corr(data = data_self,\n                           vars_of_interest = c(\"dif\",\n                                                \"age\"),\n                           sample_size = 20:149, \n                           k = 10, \n                           name = \"Self-evaluations mPFC corr. with age\")\n\n# plot figure 3C\nselfeval_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-3c-1.png){#fig-3c}\n:::\n:::\n\n\nPlot Figure 4c for the Self-evaluations task mPFC ROI:\n\n\n::: {#cell-fig-4c .cell}\n\n```{.r .cell-code}\n#| label: fig-4c\n# plot figure 4c\nselfeval_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-4c-1.png){#fig-4c}\n:::\n:::\n\n\nSet seed and create Figure 3D for the Gaining for self task NAcc ROI:\n\n\n::: {#cell-fig-3d .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-3d\n\n# set seed\nset.seed(1234)\n\n# calculate difference nacc_selfgain vs. nacc_bothnogain\ndata_vicar <- vicar_char\ndata_vicar$dif <- data_vicar$nacc_selfgain - data_vicar$nacc_bothnogain\n\n# Estimate correlations\nvicar_char_fig <- estim_corr(data = data_vicar, \n                             vars_of_interest = c(\"dif\", \n                                                  \"age\"),\n                             sample_size = 20:156, \n                             k = 10, \n                             name = \"Gaining self NAcc corr. with age\")\n\n# plot figure 3D\nvicar_char_fig$fig_corr\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-3d-1.png){#fig-3d}\n:::\n:::\n\n\nPlot Figure 4d for the Gaining for self task NAcc ROI:\n\n\n::: {#cell-fig-4d .cell}\n\n```{.r .cell-code}\n#| label: fig-4d\n# plot figure 4d\nvicar_char_fig$fig_corr_nozero\n```\n\n::: {.cell-output-display}\n![](figures-correlations_files/figure-ipynb/fig-4d-1.png){#fig-4d}\n:::\n:::\n\n\nCombine figures 3A-D in one figure for Pearson's correlations:\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nfeedback_fig$fig_corr + gambling_fig$fig_corr + selfeval_fig$fig_corr + vicar_char_fig$fig_corr\n```\n:::\n\n\nExtract numbers to produce table 3:\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: data-summary\n\n# first extract tibble from results (select mean only)\nfeedback <- as_tibble(feedback_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngambling <- as_tibble(gambling_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\nselfeval <- as_tibble(selfeval_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngaining <- as_tibble(vicar_char_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\n```\n:::\n\n\nUse numbers to produce a table in text:\n\n| task             | brain region | n = 20                                                                                                                    | n = 2/5                                                                                                                                                | n = 3/5                                                                                                                                                | n = 4/5                                                                                                                                                | N = total                                                                                                                                              |\n|-----------|-----------|-----------|-----------|-----------|-----------|-----------|\n| Feedback         | DLPFC        | **0.39** (-0.05, 0.7 ) | **0.42** (0.21, 0.6 ), *n =* 70 | **0.38** (0.21, 0.52 ), *n =* 120 | **0.36** (0.22, 0.48 ), *n =* 170 | **0.38** (0.27, 0.47 ), *N* = 271 |\n| Gambling         | NAcc         | **-0.04** (-0.47, 0.4 ) | **0.01** (-0.25, 0.26 ), *n =* 60 | **-0.01** (-0.21, 0.19 ), *n =* 100 | **-0.03** (-0.2, 0.13 ), *n =* 140 | **-0.04** (-0.17, 0.09 ), *N =* 221 |\n| Self-evaluations | mPFC         | **0.05** (-0.39, 0.47 ) | **0.11** (-0.18, 0.38 ), *n =* 46 | **0.05** (-0.18, 0.28 ), *n =* 72 | **0.06** (-0.14, 0.26 ), *n =* 98 | **0.06** (-0.1, 0.22 ), *N* = 149 |\n| Gaining self     | NAcc         | **-0.29** (-0.64, 0.16 )    | **-0.09** (-0.37, 0.2 ), *n =* 47     | **-0.12** (-0.33, 0.11 ), *n =* 74     | **-0.13** (-0.32, 0.07 ), *n =* 101     | **-0.17** (-0.31, -0.01 ), *N* = 156     |\n\n: Table 3 {tbl-3 #| label: tbl-3-lbl}\n\nSee @tbl-3 for more info, see also @fig-3a and @tbl-3\n\n",
    "supporting": [
      "figures-correlations_files/figure-ipynb"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}