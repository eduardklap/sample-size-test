{
  "hash": "7b481bcc3cae5d13806f0c094c06d904",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Code for Figures 1-2 based on Cohen's d\"\nauthor: \"Eduard Klapwijk\"\n---\n\n\nLoad libraries to produce figures:\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\n# load libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(patchwork)\n# load devtools library and load neuro-up package from github repo\nlibrary(devtools)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLoading required package: usethis\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\ninstall_github(\"eduardklap/neuroUp\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDownloading GitHub repo eduardklap/neuroUp@HEAD\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nInstalling 1 packages: rlang\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nInstalling package into '/home/eklapwijk/R/x86_64-pc-linux-gnu-library/3.6'\n(as 'lib' is unspecified)\nInstalling package into '/home/eklapwijk/R/x86_64-pc-linux-gnu-library/3.6'\n(as 'lib' is unspecified)\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| error: FALSE\n#| warning: FALSE\n#| results: FALSE\n#| include: FALSE\nlibrary(neuroUp)\n```\n:::\n\n\nSet seed and create Figure 1a for the Feedback task DLPFC ROI:\n\n::: {#cell-fig-1a .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-1a\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# Estimate differences (unstandardized and Cohen's d)\nfeedback_fig <- estim_diff(data = feedback,\n                           vars_of_interest = c(\"mfg_learning\",\n                                                \"mfg_application\"),\n                           sample_size = 20:271, \n                           k = 1000, \n                           name = \"A. Feedback DLPFC\")\n\n# plot figure 1a\nfeedback_fig$fig_cohens_d\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-1a-1.png){#fig-1a width=672}\n:::\n:::\n\n\nPlot Figure 2a for the Feedback task DLPFC ROI:\n\n::: {#cell-fig-2a .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-2a\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 2a\nfeedback_fig$fig_d_nozero\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-2a-1.png){#fig-2a width=672}\n:::\n:::\n\n\nSet seed and create Figure 1b for the Gambling task NAcc ROI:\n\n::: {#cell-fig-1b .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-1b\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# Estimate differences (unstandardized and Cohen's d)\ngambling_fig <- estim_diff(data = gambling, \n                           vars_of_interest = c(\"lnacc_self_win\", \n                                                \"lnacc_self_loss\"), \n                           sample_size = 20:221, \n                           k = 1000, \n                           name = \"B. Gambling NAcc\")\n# plot figure 1b\ngambling_fig$fig_cohens_d\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-1b-1.png){#fig-1b width=672}\n:::\n:::\n\n\nPlot Figure 2b for the  Gambling task NAcc ROI:\n\n::: {#cell-fig-2b .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-2b\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 2b\ngambling_fig$fig_d_nozero\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-2b-1.png){#fig-2b width=672}\n:::\n:::\n\n\nSet seed and create Figure 1c for the Self-evaluations task mPFC ROI:\n\n::: {#cell-fig-1c .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-1c\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# Estimate differences (unstandardized and Cohen's d)\nselfeval_fig <- estim_diff(data = self_eval, \n                           vars_of_interest = c(\"mpfc_self\", \n                                                \"mpfc_control\"),\n                           sample_size = 20:149, \n                           k = 1000, \n                           name = \"C. Self-evaluations mPFC\")\n\n# plot figure 1c\nselfeval_fig$fig_cohens_d\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-1c-1.png){#fig-1c width=672}\n:::\n:::\n\n\nPlot Figure 2c for the Self-evaluations task mPFC ROI:\n\n::: {#cell-fig-2c .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-2c\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 2c\nselfeval_fig$fig_d_nozero\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-2c-1.png){#fig-2c width=672}\n:::\n:::\n\n\nSet seed and create Figure 1d for the Gaining for self task NAcc ROI:\n\n::: {#cell-fig-1d .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-1d\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# set seed\nset.seed(1234)\n\n# Estimate differences (unstandardized and Cohen's d)\nvicar_char_fig <- estim_diff(data = vicar_char, \n                             vars_of_interest = c(\"nacc_selfgain\", \n                                                  \"nacc_bothnogain\"),\n                             sample_size = 20:156, \n                             k = 1000, \n                             name = \"D. Gaining self NAcc\")\n\n# plot figure 1d\nvicar_char_fig$fig_cohens_d\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-1d-1.png){#fig-1d width=672}\n:::\n:::\n\n\nPlot Figure 2d for the Gaining for self task NAcc ROI:\n\n::: {#cell-fig-2d .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-2d\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# plot figure 2d\nvicar_char_fig$fig_d_nozero\n```\n\n::: {.cell-output-display}\n![](figures-cohens_d_files/figure-html/fig-2d-1.png){#fig-2d width=672}\n:::\n:::\n\n\nPlot Figure 1 (4 data sets combined):\n\n::: {#cell-fig-1 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-1\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n#| fig-height: 6\n#| fig-width: 10\n#| fig-cap: \"Estimates of task effects for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset). For each sample size 10 randomly chosen HDCI’s out of the 1000 HDCI’s computed are displayed (in light blue, permutation numbers used are displayed to the right of each subfigure). The average estimate with credible interval summarizing the 1000 HDCI’s for each sample size are plotted in reddish purple. DLPFC = dorsolateral prefrontal cortex; mPFC = medial prefrontal cortex; NAcc = nucleus accumbens.\"\n# plot figure 1 using patchwork library\nfeedback_fig$fig_cohens_d + gambling_fig$fig_cohens_d + selfeval_fig$fig_cohens_d + vicar_char_fig$fig_cohens_d\n```\n\n::: {.cell-output-display}\n![Estimates of task effects for five different sample sizes (starting with $N=20$, then 1/5th parts of the total dataset). For each sample size 10 randomly chosen HDCI’s out of the 1000 HDCI’s computed are displayed (in light blue, permutation numbers used are displayed to the right of each subfigure). The average estimate with credible interval summarizing the 1000 HDCI’s for each sample size are plotted in reddish purple. DLPFC = dorsolateral prefrontal cortex; mPFC = medial prefrontal cortex; NAcc = nucleus accumbens.](figures-cohens_d_files/figure-html/fig-1-1.png){#fig-1 width=960}\n:::\n:::\n\n\nPlot Figure 2 (4 data sets combined):\n\n::: {#cell-fig-2 .cell}\n\n```{.r .cell-code .hidden}\n#| label: fig-2\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n#| fig-height: 6\n#| fig-width: 10\n#| fig-cap: \"For each task, for five different sample sizes (starting with $n=20$, then 1/5th parts of the total dataset), the proportion of intervals not containing the value 0 is plotted in reddish purple.\"\n# plot figure 2 using patchwork library\nfeedback_fig$fig_d_nozero + gambling_fig$fig_d_nozero + selfeval_fig$fig_d_nozero + vicar_char_fig$fig_d_nozero\n```\n\n::: {.cell-output-display}\n![For each task, for five different sample sizes (starting with $n=20$, then 1/5th parts of the total dataset), the proportion of intervals not containing the value 0 is plotted in reddish purple.](figures-cohens_d_files/figure-html/fig-2-1.png){#fig-2 width=960}\n:::\n:::\n\n\nExtract numbers to make table 2:\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: data-summary-cohens\n#| eval: TRUE\n#| echo: FALSE\n#| message: FALSE\n#| warning: FALSE\n# first extract tibble from results (select mean only)\nfeedback_sum <- as_tibble(feedback_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngambling_sum <- as_tibble(gambling_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\nselfeval_sum <- as_tibble(selfeval_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\ngaining_sum <- as_tibble(vicar_char_fig$tbl_select) %>%\n  dplyr::filter(permutation == \"Overall\")\n```\n:::\n\n\nUse numbers to produce a table in text:\n\n| task             | brain region | n = 20                                                                                                                             | n = 2/5                                                                                                                                                             | n = 3/5                                                                                                                                                             | n = 4/5                                                                                                                                                             | N = total                                                                                                                                                           |\n|-----------|-----------|-----------|-----------|-----------|-----------|-----------|\n| Feedback         | DLPFC        | **2.03** (1.29, 2.76) | **1.89** (1.54, 2.25), *n* = 70 | **1.88** (1.62, 2.15), *n* = 120 | **1.87** (1.65, 2.1), *n* = 170 | **1.87** (1.69, 2.04), *N* = 271 |\n| Gambling         | NAcc         | **0.8** (0.25, 1.34) | **0.74** (0.45, 1.03), *n* = 60 | **0.73** (0.51, 0.96), *n* = 100 | **0.73** (0.54, 0.92), *n* = 140 | **0.73** (0.58, 0.88), *N* = 221 |\n| Self-evaluations | mPFC         | **0.5** (0.02, 0.98) | **0.47** (0.17, 0.77), *n* = 46 | **0.46** (0.22, 0.7), *n* = 72 | **0.46** (0.26, 0.66), *n* = 98 | **0.46** (0.29, 0.62), *N* = 149 |\n| Gaining self     | NAcc         | **0.64** (0.14, 1.14)    | **0.59** (0.27, 0.91), *n* = 47     | **0.58** (0.32, 0.84), *n* = 74     | **0.58** (0.36, 0.8), *n* = 101     | **0.57** (0.39, 0.75), *N* = 156     |\n",
    "supporting": [
      "figures-cohens_d_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}